# 战斗演绎系统设计文档

## 设计概述

本文档定义了一套基于**简洁小说叙事风格**的战斗文字演出系统，用于配合战斗设计文档，提供标准化的战斗过程展示。

### 设计原则

1. **简洁叙事**：采用"标准四段式"结构，单回合字数控制在 100-150 字，使用小说演绎的沉浸感。
2. **结构化演出**：
    - **第一行（战场环境）**：用先手方语言（暗示）、先手方机体系统提醒（明示）或第三人称描述，展示先手归属与当前交战距离。
    - **第二行（先手攻击）**：根据圆桌判定结果选择视角——命中类（Miss/Hit/Crit）从攻击方视角描述武器动作和攻击效果，防御类（Dodge/Parry/Block）从防御方视角描述机体动作和防御效果。
    - **第三行（后手反击）**：同第二行，根据后手方攻击的圆桌判定结果选择对应视角进行描述。
    - **第四行（回合总结）**：描述双方位移、姿态或战地氛围。


---

## 完整示例 (标准四段式)

**ROUND1**
- **[环境]** 雷达接触！米诺夫斯基粒子在 5200m 外形成淡淡的干扰波纹，高达凭借先进的传感器系统率先锁定目标——先手归我。
- **[先手]** 阿姆罗深吸一口气扣下扳机，光束步枪的火舌瞬间贯穿宇宙的黑暗，精准刺入扎古装甲的连接薄弱处。（暴击！伤害 1560） ✨【NT感知】触发。
- **[反击]** 爆炸的烟尘中扎古猛然转身，光束火箭炮呼啸而至——高达的复合盾牌应声展开，微型I力场将这记重击稳稳化解。（格挡(阿纳海姆)！伤害 500）
- **[总结]** 首发即见血，战场在刹那间被点燃。双方的机体拖曳着推进器的尾焰，消失在粒子云的迷雾深处。

**ROUND2**
- **[环境]** 扎古猛然开启全功率推进，借助上回合积累的战术优势强行夺回先手——距离迅速压缩至 2800m，已进入中距离炮战圈。
- **[先手]** 夏亚冷笑一声，扎古的120mm机炮疯狂倾泻，弹幕织成火网笼罩了高达。子弹如雨点般砸在装甲上，火花四溅。（命中！伤害 680） 🔥【压制火线】
- **[反击]** 高达在弹雨中灵巧翻滚，阿姆罗凭借新人类的直觉感知到攻击轨迹，光束步枪瞬发——但扎古推进器爆发，惊险避开了这记致命反击。（躲闪！伤害 0）
- **[总结]** 攻守易势！机体喷射的氮气在黑暗中交错出诡异的弧线，战况陷入胶着的死亡螺旋。

**ROUND3**
- **[环境]** 两台机体已近得能看清对方驾驶舱的红色独眼，1200m——这是刀与火的领域。高达抢回主动权，率先出击。
- **[先手]** 光束军刀从腰部挂架中抽出的刹那，机体已化作白色闪光！刀刃精准刺向扎古背部的推进器喷口，炸开一团耀眼的电弧。（命中！伤害 1200）
- **[反击]** 扎古在损伤中强行扭转机体，热能斧划出赤红的弧线——但因角度偏差，斧刃只是从高达肩甲边缘擦过，未能造成实质伤害。（未命中！伤害 0）
- **[总结]** 金属撞击的震荡波在通讯频段中回响，两台受损的机体错身而过，留下螺旋状的尾迹。

**ROUND4**
- **[环境]** 生死系于一线！300m——两台MS几乎贴身纠缠，火线与刀光在宇宙中交织出致命的舞蹈。高达抓住最后的进攻机会。
- **[先手]** 阿姆罗咬紧牙关，将光束步枪的枪口直抵扎古的动力舱外壁——机体系统瞬间超频到危险的红线。扣动扳机，白光吞没一切！（暴击！伤害 2200） ⚙️【性能过载】
- **[反击]** 扎古在爆炸中做出最后的临死反击，热能斧重重劈向高达的肩部——但厚重的新吉翁装甲硬抗住了这记斩击。（格挡(新吉翁)！伤害 300）
- **[总结]** 【战斗结束】扎古的动力室发生连锁殉爆，机体化作火球向地面坠落。阿姆罗驾驶着冒烟的高达，在战场上空静静悬浮——白色恶魔的传说，又多了一笔战绩。

---

## 模板库详细设计 (API 映射完整版)

### 第一行：战场环境 Environment(winner, reason, distance)

#### 参数说明
- `winner`: 先手方机体名称
- `reason`: 先手原因 (performance/pilot/advantage/counter)
- `distance`: 当前距离数值

#### 模板库（每种原因 × 3 变体）

**先手原因：performance (机体性能优势)**
```yaml
templates:
  - "{winner}的机体传感器首先捕捉到敌踪，在 {distance}m {range_tag}区间抢得先机——性能优势显露无疑。"
  - "雷达锁定！{winner}凭借卓越的机动性在 {distance}m 处率先完成瞄准，先手权归我。"
  - "米诺夫斯基粒子干扰中，{winner}的高精度火控系统在 {distance}m 外率先锁敌，战斗节奏由此掌控。"
```

**先手原因：pilot (驾驶员感知优势)**
```yaml
templates:
  - "驾驶员的直觉在千钧一发间爆发！{winner}在 {distance}m {range_tag}抢先出手。"
  - "{winner}的驾驶员展现出惊人的战场洞察力，在 {distance}m 距离上精准预判了敌机轨迹！"
  - "新人类的感知穿透了战场迷雾，{winner}在 {distance}m 处捕捉到一瞬即逝的破绽。"
```

**先手原因：advantage (上回合优势延续)**
```yaml
templates:
  - "乘胜追击！{winner}延续上回合建立的战术优势，在 {distance}m {range_tag}继续压制。"
  - "节奏已被把控，{winner}借助累积的优势值在 {distance}m 处再度抢得先机。"
  - "战场主动权牢牢在握，{winner}在 {distance}m 的距离上展开新一轮攻势。"
```

**先手原因：counter (劣势机体反超)**
```yaml
templates:
  - "绝地反击！{winner}虽然机体劣势，但凭借积累的战术优势强行扭转局面，在 {distance}m {range_tag}夺回先手。"
  - "局势反转！{winner}抓住敌机动作的僵直期，在 {distance}m 距离强势反超。"
  - "不可能的逆转！{winner}在绝境中爆发，于 {distance}m 处硬生生抢回了战斗主导权。"
```

---

### 第二/三行：攻防动作 Action(attacker, weapon, defender, result, damage, skill)

#### 攻击方视角（命中类判定）

**判定：未命中 (Miss)**
```yaml
templates:
  - "{attacker}扣动{weapon}的扳机，但光束在米诺夫斯基粒子的干扰下偏离了轨道，从{defender}身旁掠过。（未命中！伤害 0）"
  - "{weapon}的攻击角度被{defender}的机动性完全破解，炮火在宇宙中画出徒劳的弧线。（未命中！伤害 0）"
  - "火控系统失准！{attacker}的{weapon}射出的光束擦着{defender}的装甲边缘飞过，未能造成任何伤害。（未命中！伤害 0）"
```

**判定：命中 (Hit)**
```yaml
templates:
  - "{attacker}稳健地操控{weapon}开火，光束/弹丸准确击中{defender}的{location}，炸开一团火光。（命中！伤害 {damage}）"
  - "{weapon}的攻击撕破了{defender}的外部装甲，{location}处引发剧烈爆炸，碎片四溅。（命中！伤害 {damage}）"
  - "精准打击！{attacker}的{weapon}命中{defender}的{location}，造成有效杀伤。（命中！伤害 {damage}）"
```

**判定：暴击 (Crit)**
```yaml
templates:
  - "致命一击！{attacker}的{weapon}以刁钻的角度贯入{defender}的{location}，引发连锁爆炸！（暴击！伤害 {damage}）"
  - "{weapon}精准命中要害！{defender}的{location}瞬间被光束洞穿，机体剧烈震颤。（暴击！伤害 {damage}）"
  - "完美的破坏！{attacker}操控{weapon}直击{defender}装甲薄弱处，{location}发生殉爆。（暴击！伤害 {damage}）"
```

**暴击：高伤害变体 (Crit + high_damage)**
```yaml
templates:
  - "毁灭性打击！{weapon}将{defender}的{location}完全粉碎，装甲碎片如流星般四散！（暴击！伤害 {damage}）"
  - "恐怖的破坏力！{defender}在{location}处发生大规模殉爆，整台机体都在火焰中扭曲！（暴击！伤害 {damage}）"
  - "{weapon}释放出超越极限的能量，{defender}的{location}被彻底贯穿，留下贯通的空洞！（暴击！伤害 {damage}）"
```

#### 防御方视角（防御类判定）

**判定：躲闪 (Dodge)**
```yaml
templates:
  - "{attacker}的{weapon}开火，但{defender}推进器全开，在千钧一发之际灵巧避开了这记攻击。（躲闪！伤害 0）"
  - "惊人的反应速度！{defender}在{weapon}击发的瞬间侧身翻滚，光束擦着装甲边缘飞过。（躲闪！伤害 0）"
  - "{defender}凭借高机动性在弹雨中穿梭，{attacker}的{weapon}未能捕捉到移动轨迹。（躲闪！伤害 0）"
```

**判定：招架 (Parry)**
```yaml
templates:
  - "精彩！{defender}用手持武器精准架住{weapon}的攻击，火花在两件武器碰撞处迸发！（招架！伤害 0）"
  - "武器相撞发出刺耳的金属摩擦声，{defender}凭借高超技巧成功化解{weapon}的打击。（招架！伤害 0）"
  - "{defender}在瞬间完成格斗架势，手中的武器硬撼{weapon}的锋芒，将攻击偏转！（招架！伤害 0）"
```

**判定：格挡 - 阿纳海姆 (Block - Anaheim)**
```yaml
templates:
  - "{defender}举起复合盾牌，微型I力场发生器嗡鸣作响，将{weapon}的冲击稳稳化解。（格挡(阿纳海姆)！伤害 {damage}）"
  - "精密格挡！{defender}的纳米装甲表面流过一层微光，强行中和了{weapon}的部分能量。（格挡(阿纳海姆)！伤害 {damage}）"
  - "{defender}的盾牌系统展开多层防护，{weapon}的攻击被逐层卸力，机体毫发无伤。（格挡(阿纳海姆)！伤害 {damage}）"
```

**判定：格挡 - 新吉翁 (Block - Zeon)**
```yaml
templates:
  - "{defender}厚重的肩甲硬顶着火光，装甲纹丝不动——这就是新吉翁的刚毅！（格挡(新吉翁)！伤害 {damage}）"
  - "{defender}利用装甲倾角将{weapon}的弹头弹开，火花在厚重的装甲板上擦出一道痕迹。（格挡(新吉翁)！伤害 {damage}）"
  - "新吉翁装甲的自信！{defender}用最厚实的部位硬抗{weapon}的直击，几乎未受损伤。（格挡(新吉翁)！伤害 {damage}）"
```

**判定：格挡 - 特别机体 (Block - Special)**
```yaml
templates:
  - "{defender}周围浮现出淡蓝色的精神感应力场，{weapon}的攻击在触及机体前被无形之力偏转。（特殊防御！伤害 {damage}）"
  - "相位转移装甲微光流转，{weapon}的物理打击被完全化解于无形。（特殊防御！伤害 {damage}）"
  - "{defender}胸部排热门全开，释放大量粒子雾气干扰{weapon}的穿透力——攻击被大幅削弱。（特殊防御！伤害 {damage}）"
```

**判定：格挡 - 通用 (Block - Default)**
```yaml
templates:
  - "{defender}举起盾牌，稳稳挡下{weapon}的攻击，盾面上留下一道焦黑的痕迹。（格挡！伤害 {damage}）"
  - "{weapon}重重砸在{defender}的盾牌上，发出沉闷的撞击声，但未能造成致命伤害。（格挡！伤害 {damage}）"
  - "{defender}的防护系统成功防御了{weapon}的大部分伤害，机体稳住姿态。（格挡！伤害 {damage}）"
```

#### 技能触发补充 (Skill Activation)

**技能触发插入模板（可插入攻击行末尾）**
```yaml
templates:
  - "✨ 核心技能【{skill_name}】触发！"
  - "🔥 驾驶员意志爆发！【{skill_name}】启动！"
  - "⚙️ 机体系统【{skill_name}】强行激活！"
```

---

### 第四行：回合总结 Summary(narrative_type, round_state)

#### 参数说明
- `narrative_type`: 叙事风格 (dramatic/normal/ending)
- `round_state`: 当前战况状态

#### 模板库

**类型：戏剧性 (Dramatic)**
```yaml
templates:
  - "双方的机体拖曳着推进器的尾焰，消失在米诺夫斯基粒子的迷雾深处——战斗远未结束。"
  - "激烈的交火后，两台MS在宇宙中拉开距离，各自寻找着对方防御的破绽。"
  - "硝烟弥漫，战场陷入短暂的静默——但杀机依然在黑暗中流动。"
  - "机体喷射的氮气在黑暗中交错出诡异的弧线，战况陷入胶着的死亡螺旋。"
  - "金属撞击的震荡波在通讯频段中回响，两台受损的机体错身而过，留下螺旋状的尾迹。"
```

**类型：普通 (Normal)**
```yaml
templates:
  - "双方暂时拉开距离，重新评估战况。"
  - "回合结束，机体系统开始自检。"
  - "战场进入短暂的对峙阶段。"
```

**类型：终结 (Ending - 胜利)**
```yaml
templates:
  - "【战斗结束】{loser}被击破，机体化作火球坠向地面。{winner}获得最终胜利。"
  - "【战斗结束】{loser}失去战斗能力，{winner}在战场上空静静悬浮——又一场战斗的胜利者。"
  - "【战斗结束】{loser}的动力室发生殉爆，{winner}拖着受损的机体返航，战场留下残骸的余烬。"
```

---

## 命中部位库 (Hit Locations)

```yaml
hit_locations:
  - "装甲连接部"
  - "驾驶舱外壁"
  - "动力管路"
  - "胸部装甲"
  - "左侧肩甲"
  - "右侧肩甲"
  - "腿部关节"
  - "背包推进器"
  - "武器挂架"
  - "传感器头部"
  - "能量分配器"
  - "姿态控制喷口"
```

---

## 总结

本系统通过**标准四段式结构**实现了：
1. **程序组装极度简便**：固定的 4 行槽位，每行对应明确的 API 输出。
2. **模板丰富度高**：每种判定结果提供 3 种变体，避免重复。
3. **演出重心明确**：命中类突出武器，防御类突出机体。
4. **氛围感强烈**：通过小说化的环境描写与总结，提升战斗沉浸感。
