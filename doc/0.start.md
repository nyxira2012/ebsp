# EBSB (Erotic Battle Simulation Base) - 项目启动概览

## 1. 项目定位
本项是一个**1v1 回合制、配置类自走棋多人网页游戏**。玩家通过格纳库（Hangar）配置机体、驾驶员和装备，进入战场后系统根据配置进行自动对决。
- **核心体验**: 策略配置（战前）+ 华丽演示（战中）。
- **设计风格**: 深受《超级机器人大战》(SRW) 影响的数值体系与战斗逻辑。

## 2. 技术栈
- **Frontend**: Next.js (React) + Zustand (状态管理) + 简易 CSS 动画。
- **Backend**: Python (核心战斗算法、数据解析) + PostgreSQL (持久化存储)。
- **Data Validation**: 采用 **Pydantic** 进行严谨的数据建模、类型校验与 JSON 序列化。
- **Communication**: 采用 JSON Snapshot（快照）机制实现“配置层”与“战斗层”的高度解耦。

## 3. 核心系统架构

### 3.1 战斗引擎 (Combat Engine)
- **圆桌判定 (One-Roll Table)**: 采用经典的单次随机数判定（Miss -> Dodge -> Parry -> Block -> Crit -> Hit）。
- **事件驱动钩子 (Hook System)**: 战斗过程被切分为多个钩子点（如 `HOOK_PRE_DAMAGE`, `HOOK_ON_KILL`），支持复杂的技能干预。

### 3.2 技能与效果系统 (Skill & Effect)
- **数据驱动**: 技能逻辑与数值从 JSON 配置加载，通过 `EffectProcessor` 流水线式处理。
- **高度解耦**: 技能不再硬编码到战斗流程中，而是通过挂载钩子实现效应。

### 3.4 数据契约 (Data Contracts)
- **强类型校验**: 使用 **Pydantic Model** 定义所有配置（机体、武器、技能）和运行时快照，确保前后端数据交换的严格一致性及运行时安全。
- **快照机制 (Snapshot)**: 养成系统的数值（机体改造、装备加成、主副驾驶修正）在出击前聚合为 `MechaSnapshot`，作为战斗引擎的唯一输入。
- **主侧重**: 纯加法叠加属性（由 Base, Upgrade, Equip, Pilot 构成）。

## 4. 开发准则
- **解耦优先**: 战斗计算不直接操作数据库实例，只处理快照数据。
- **长命名规范**: 遵循 snake_case，既不极端冗长也不过度简写（如 `final_armor`, `stat_shooting`）。
- **文档同步**: 所有的核心系统迭代必须在 `doc/` 目录下有对应的设计文档。

---
*注：本项目文档目前处于 v1.5 设计迭代阶段，核心逻辑位于 `src/` 目录下。*
